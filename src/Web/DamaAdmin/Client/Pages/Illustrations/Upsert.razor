@page "/ilustracoes/editar/{Id:int?}"

@if (IsNew)
{
    <h2>Nova Ilustração</h2>
}
else
{
    <h2>Editar Ilustração @model?.Name</h2>
}

<hr />

@if (!IsNew && model == null)
{
    <p><em>A Carregar...</em></p>
}
else
{
    <EditForm Model="@model" OnValidSubmit="@HandleValidSubmit">
        <div class="row">
            <div class="col-md-4">
                <DataAnnotationsValidator />
                <ValidationSummary />
                <div class="form-group required">
                    <label>Código</label>
                    <InputText @bind-Value="model.Code" class="form-control" />
                    <ValidationMessage For="@(() => model.Code)" />
                </div>
                <div class="form-group required">
                    <label>Nome</label>
                    <InputText @bind-Value="model.Name" class="form-control" />
                    <ValidationMessage For="@(() => model.Name)" />
                </div>
                <div class="form-group required">
                    <label>Tipo de Ilustração</label>
                    <InputSelect @bind-Value="model.IllustrationTypeId" class="form-control">
                        @if (allIllustrationTypes.Count() == 0)
                        {
                            <option class="font-italic">Loading...</option>
                        }
                        else
                        {
                            <option></option>
                            @foreach (var item in allIllustrationTypes)
                            {
                                <option value="@item.Id">@item.Name</option>
                            }
                        }
                    </InputSelect>
                    <span asp-validation-for="model.IllustrationTypeId" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary" disabled=@_isSubmitting>
                        @if (!_isSubmitting)
                        {
                            <span>Atualizar</span>
                        }
                        else
                        {
                            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                            <span>A atualizar...</span>
                        }
                    </button>

                    @if (!string.IsNullOrEmpty(statusMessage))
                    {
                        @if (statusMessage.StartsWith("Erro"))
                        {
                            <ul class="validation-errors">
                                <li class="validation-message">@statusMessage</li>
                            </ul>
                        }
                        else
                        {
                            <div class="alert alert-success">@statusMessage</div>
                        }
                    }
                </div>
            </div>
        </div>
    </EditForm>
}
<div>
    <a href="/ilustracoes">Voltar para a lista</a>
</div>